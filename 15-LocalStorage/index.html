<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>15-LocalStorage</title>
	<link rel="stylesheet" href="app.css">
</head>
<body>
	<div class="wrapper">
		<h2>Local Tapas</h2>
		<p></p>
		<ul class="plates">
			<li>Loading Tapas...</li>
		</ul>
		<form class="add-items">
			<input type="text" name="item" placeholder="Item Name" required="required">
			<input type="submit" value="+ Add Item">
		</form>
	</div>

	<script>
		const addItems = document.querySelector('.add-items');
		const itemsList = document.querySelector('.plates');

		const items = JSON.parse(localStorage.getItem('items')) || [];

		function addItem (e) {
			e.preventDefault();
			const text = (this.querySelector('[name=item]')).value;
			// console.log(text);
			const item = {
				text,
				done: false
			};

			items.push(item);
			// console.clear();
			// console.table(items);
			populateList(items, itemsList);
			localStorage.setItem('items', JSON.stringify(items));
			this.reset();
		}

		function populateList (plates = [], platesList) {
			platesList.innerHTML = plates.map((plate, i) => {
				return `
					<li>
						<input type="checkbox" id="item${i}" data-index=${i} ${plate.done ? 'checked' : ''} />
						<label for="item${i}">${plate.text}</label>
					</li>
				`;
			}).join('');
		}

		function toggleDone (e) {
			console.log(e.target);
		}

		addItems.addEventListener('submit', addItem);
		itemsList.addEventListener('click', toggleDone);

		populateList(items, itemsList);
	</script>
</body>
</html>
